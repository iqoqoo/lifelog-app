<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ­ã‚°ä¸€è¦§</title>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/utc.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/timezone.js"></script>
  <script>
    dayjs.extend(dayjs_plugin_utc);
    dayjs.extend(dayjs_plugin_timezone);
  </script>
</head>
<body>
  <h1>ä¿å­˜ã•ã‚ŒãŸãƒ©ã‚¤ãƒ•ãƒ­ã‚°</h1>
  <ul id="logList"></ul>

  <script>
    const logs = JSON.parse(localStorage.getItem("lifeLogs") || "[]");
    const logList = document.getElementById("logList");

    logs.forEach(log => {
  const li = document.createElement("li");
  // timestampãŒã‚ã‚Œã°æ•´å½¢ã€ãªã‘ã‚Œã°ç©ºæ–‡å­—
  const formattedTime = log.timestamp
    ? dayjs(log.timestamp).tz('Asia/Tokyo').format('HH:mm')
    : '';

  li.textContent = `ğŸ“… ${log.date} ${formattedTime}ï½œ ğŸ©º ä½“èª¿: ${log.condition} ï½œ ğŸš é£Ÿäº‹: ${log.meals}`;
  logList.appendChild(li);
});


    if (logs.length === 0) {
      const li = document.createElement("li");
      li.textContent = "ã¾ã ãƒ­ã‚°ãŒã‚ã‚Šã¾ã›ã‚“ã€‚";
      logList.appendChild(li);
    }
  </script>

<!-- ãƒœã‚¿ãƒ³éƒ¨åˆ† -->
<button id="save-log">ãƒ­ã‚°ã‚’ä¿å­˜ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰</button>
<input type="file" id="load-log" accept=".json" style="display:none;">
<button id="load-log-btn">ãƒ­ã‚°ã‚’å¾©å…ƒï¼ˆèª­ã¿è¾¼ã¿ï¼‰</button>

<script>
// ä¿å­˜ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰
document.getElementById('save-log').addEventListener('click', function () {
  const data = localStorage.getItem('lifelog');
  if (!data) {
    alert('ä¿å­˜ã™ã‚‹ãƒ­ã‚°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚');
    return;
  }
  const blob = new Blob([data], { type: 'application/json' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'lifelog_backup.json';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
});

// å¾©å…ƒï¼ˆèª­ã¿è¾¼ã¿ï¼‰
document.getElementById('load-log-btn').addEventListener('click', function () {
  document.getElementById('load-log').click();
});

document.getElementById('load-log').addEventListener('change', function (event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function (e) {
    try {
      const data = JSON.parse(e.target.result);
      localStorage.setItem('lifelog', JSON.stringify(data));
      alert('ãƒ­ã‚°ã‚’å¾©å…ƒã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
    } catch (err) {
      alert('èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚');
    }
  };
  reader.readAsText(file);
});
</script>



</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ­ã‚°ä¸€è¦§</title>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/utc.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/timezone.js"></script>
  <script>
    dayjs.extend(dayjs_plugin_utc);
    dayjs.extend(dayjs_plugin_timezone);
  </script>
</head>
<body>
  <h1>ä¿å­˜ã•ã‚ŒãŸãƒ©ã‚¤ãƒ•ãƒ­ã‚°</h1>
  <ul id="logList"></ul>

  <script>
    const logs = JSON.parse(localStorage.getItem("lifeLogs") || "[]");
    const logList = document.getElementById("logList");

    logs.forEach(log => {
  const li = document.createElement("li");
  // timestampãŒã‚ã‚Œã°æ•´å½¢ã€ãªã‘ã‚Œã°ç©ºæ–‡å­—
  const formattedTime = log.timestamp
    ? dayjs(log.timestamp).tz('Asia/Tokyo').format('HH:mm')
    : '';

  li.textContent = `ğŸ“… ${log.date} ${formattedTime}ï½œ ğŸ©º ä½“èª¿: ${log.condition} ï½œ ğŸš é£Ÿäº‹: ${log.meals}`;
  logList.appendChild(li);
});


    if (logs.length === 0) {
      const li = document.createElement("li");
      li.textContent = "ã¾ã ãƒ­ã‚°ãŒã‚ã‚Šã¾ã›ã‚“ã€‚";
      logList.appendChild(li);
    }
  </script>

<button id="save-log">ãƒ­ã‚°ã‚’ä¿å­˜ã™ã‚‹</button>

<script>
document.getElementById('save-log').addEventListener('click', function () {
  // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const data = localStorage.getItem('lifelog');

  if (!data) {
    alert('ä¿å­˜ã™ã‚‹ãƒ­ã‚°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚');
    return;
  }

  // Blob ã‚’ä½œæˆã—ã¦ JSON ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜
  const blob = new Blob([data], { type: 'application/json' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'lifelog_backup.json'; // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«å
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url); // ãƒ¡ãƒ¢ãƒªé–‹æ”¾
});
</script>


</body>
</html>